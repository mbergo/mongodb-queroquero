replicaSetName: rs0
replicaSetHostnames: true

architecture: replicaset

replicaCount: 3
arbiter:
  enabled: true

auth:
  enabled: false

image:
  registry: docker.io
  repository: bitnami/mongodb
  tag: 7.0.12-debian-12-r6
  pullPolicy: IfNotPresent

persistence:
  enabled: true
  size: 50Gi

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 250m
    memory: 256Mi

arbiter:
  persistence:
    enabled: false

# Node Selector to spread replicas across nodes with "data-private" label
nodeSelector:
  data-private: "true"

# Pod Affinity and Anti-Affinity for better distribution across nodes
affinity:
  podAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
            - key: "app"
              operator: In
              values:
                - mongodb
        topologyKey: "kubernetes.io/hostname"
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: "app"
                operator: In
                values:
                  - mongodb
          topologyKey: "kubernetes.io/hostname"

tolerations:
  - key: "data-private"
    operator: "Exists"
    effect: "NoSchedule"

# External Access Configuration using NodePort for VMware environment
externalAccess:
  enabled: true
  service:
    type: NodePort
    nodePorts: [] # Kubernetes will auto-assign NodePort
    port: 27017
    annotations: {} # Any specific annotations needed can go here
  autoDiscovery:
    enabled: true # Enables auto-discovery, making it easier for nodes to join the replica set
  servicePerPod: false # Use a single service for the entire replica set

# External Access host and IP configuration (optional, leave empty for auto-discovery)
externalAccessHostnames: []
externalAccessIPs: []

# Probes (Optional but recommended for production environments)
livenessProbe:
  enabled: true
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5

readinessProbe:
  enabled: true
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5

# Additional configurations (Optional based on the needs of your environment)
diagnosticMode:
  enabled: false
  command: ['sleep']
  args: ['infinity']